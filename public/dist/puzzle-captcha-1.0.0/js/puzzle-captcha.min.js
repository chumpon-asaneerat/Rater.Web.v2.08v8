(function(t){t.fn.PuzzleCAPTCHA=function(e){var p=t.extend({imageURL:"http://www.choikangstory.com/test-image.jpg",width:"auto",height:"auto",columns:3,rows:2,targetInput:null,targetVal:null,targetButton:null},e);tmpW=p.width,"auto"!=tmpW&&(tmpW+="px"),tmpH=p.height,"auto"!=tmpH&&(tmpH+="px");var m=this;return m.addClass("puzzleCAPTCHA"),m.append('<div class="pcBox"><div class="pcBoxBG"><img src="'+p.imageURL+'" style="width:'+tmpW+";height:"+tmpH+';"></div></div> <div class="pcAnswer"></div>'),m.find(".pcBoxBG img").load(function(){tmpImg=t(this),"auto"==p.width?tmpW=tmpImg.width():tmpW=p.width,"auto"==p.height?tmpH=tmpImg.height():tmpH=p.height,itemW=Math.round(tmpW/p.columns),itemH=Math.round(tmpH/p.rows),m.find(".pcAnswer").width(itemW).height(itemH).append(tmpImg.clone()).css({"margin-top":tmpH/2-itemH/2}),m.find(".pcBox").width(tmpW-1),m.find(".pcBox").height(tmpH-1),tmpAnswer=Math.floor(Math.random()*p.columns*p.rows);var e,i,n,a;for(n=t(document.createElement("div")),n.addClass("pcBoxItem"),a=0,e=0;e<p.columns;e++)for(i=0;i<p.rows;i++)tmpLeft=itemW*e,tmpTop=itemH*i,a==tmpAnswer&&(answerLeft=tmpLeft,answerTop=tmpTop),_item=n.clone().attr("data-val",a).css({width:itemW,height:itemH,left:tmpLeft,top:tmpTop}).append(tmpImg.clone()),m.find(".pcBox").append(_item),a++;m.find(".pcBoxItem img, .pcAnswer img").css({"margin-left":answerLeft*-1,"margin-top":answerTop*-1}).width(tmpW).height(tmpH),m.find(".pcBoxItem").click(function(){t(this).data("val")==tmpAnswer&&(m.find(".pcBoxItem").fadeOut(300),null!=p.targetInput&&t(p.targetInput).val(p.targetVal),null!=p.targetButton&&t(p.targetButton).prop("disabled",!1))})}),this}})(jQuery);